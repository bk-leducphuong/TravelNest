### Payment API Test Requests
### RESTful API endpoints following RESTful standards
### 
### Prerequisites:
### 1. Make sure the server is running (default: http://localhost:3000)
### 2. You need to be authenticated (session cookie required)
### 3. For authentication, you may need to login first via /api/auth endpoints

@baseUrl = http://localhost:3000
@contentType = application/json

### Variables (update these with your actual values)
@bookingId = 1
@transactionId = 1
@paymentMethodId = pm_1234567890
@sessionCookie = your-session-cookie-here

###############################################
### PAYMENTS RESOURCE
###############################################

### GET /api/payments
### Get all payments for authenticated user (with pagination)
### Query params: page (default: 1), limit (default: 20)
GET {{baseUrl}}/api/payments
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### GET /api/payments (With pagination)
### Get payments with custom pagination
GET {{baseUrl}}/api/payments?page=1&limit=10
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### GET /api/payments (Page 2)
### Get second page of payments
GET {{baseUrl}}/api/payments?page=2&limit=20
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### POST /api/payments
### Create a payment intent for booking
POST {{baseUrl}}/api/payments
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

{
  "paymentMethodId": "{{paymentMethodId}}",
  "amount": 150.00,
  "currency": "USD",
  "bookingDetails": {
    "bookingCode": "ABC123",
    "hotelId": 1,
    "checkInDate": "2024-12-01",
    "checkOutDate": "2024-12-05",
    "numberOfGuests": 2,
    "bookedRooms": [
      {
        "room_id": 1,
        "roomQuantity": 1
      }
    ]
  }
}

###

### POST /api/payments (Invalid - missing required fields)
### Should return 400 Bad Request
POST {{baseUrl}}/api/payments
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

{
  "paymentMethodId": "{{paymentMethodId}}"
}

###

### POST /api/payments (Invalid - invalid date range)
### Should return 400 Bad Request (checkOutDate must be after checkInDate)
POST {{baseUrl}}/api/payments
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

{
  "paymentMethodId": "{{paymentMethodId}}",
  "amount": 150.00,
  "currency": "USD",
  "bookingDetails": {
    "bookingCode": "ABC123",
    "hotelId": 1,
    "checkInDate": "2024-12-05",
    "checkOutDate": "2024-12-01",
    "numberOfGuests": 2,
    "bookedRooms": [
      {
        "room_id": 1,
        "roomQuantity": 1
      }
    ]
  }
}

###

### POST /api/payments (Invalid - invalid currency)
### Should return 400 Bad Request (currency must be 3-letter code)
POST {{baseUrl}}/api/payments
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

{
  "paymentMethodId": "{{paymentMethodId}}",
  "amount": 150.00,
  "currency": "US",
  "bookingDetails": {
    "bookingCode": "ABC123",
    "hotelId": 1,
    "checkInDate": "2024-12-01",
    "checkOutDate": "2024-12-05",
    "numberOfGuests": 2,
    "bookedRooms": [
      {
        "room_id": 1,
        "roomQuantity": 1
      }
    ]
  }
}

###

### GET /api/payments/bookings/:bookingId
### Get payment information by booking ID
GET {{baseUrl}}/api/payments/bookings/{{bookingId}}
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### GET /api/payments/bookings/:bookingId (Invalid - booking not found)
### Should return 404 Not Found
GET {{baseUrl}}/api/payments/bookings/99999
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### GET /api/payments/transactions/:transactionId
### Get payment information by transaction ID
GET {{baseUrl}}/api/payments/transactions/{{transactionId}}
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

### GET /api/payments/transactions/:transactionId (Invalid - transaction not found)
### Should return 404 Not Found
GET {{baseUrl}}/api/payments/transactions/99999
Content-Type: {{contentType}}
Cookie: connect.sid={{sessionCookie}}

###

###############################################
### AUTHENTICATION TEST
###############################################

### GET /api/payments (Unauthenticated)
### Should return 401 Unauthorized if not authenticated
GET {{baseUrl}}/api/payments
Content-Type: {{contentType}}

###

###############################################
### ERROR RESPONSE EXAMPLES
###############################################

### Expected Success Response Format:
### {
###   "data": { ... }
### }
###
### Expected Pagination Response Format:
### {
###   "data": [ ... ],
###   "meta": {
###     "page": 1,
###     "limit": 20,
###     "total": 0
###   }
### }
###
### Expected Error Response Format:
### {
###   "error": {
###     "code": "ERROR_CODE",
###     "message": "Human readable message",
###     "fields": { ... }  // Optional, for validation errors
###   }
### }
